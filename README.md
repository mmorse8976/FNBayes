# FNBayes

This code sample represents an idea from the last chapter of my dissertation which aims to account for imperfect detection when surveying species communities. In the chapter, I generated 1000 metacommunity datasets and used an occupancy model to estimate false negative probabilities of unobserved site-species combinations. To avoid having to run the Bayesian occupancy model (which takes a long time to fit and requires installing several finicky R packages), here I illustrate an alternative method for estimating false negative probabilities. First, I simulate posterior distributions for parameters psi (occurrence probability) and p (detection probability) for all 600 site-species combinations (10 species at 60 sites). These posterior distributions are similar to what could be extracted from an occupancy model. For each psi and p combination, I sample from a bernoulli distribution to generate both presence/absence (represented by z) and detection/non-detection (represented by y). Using Bayes theorem, I calculate the ratio of false negative estimates given a psi and p combination, resulting in distributions of false negative probabilities. I focus on the means of the false negative probability distributions, but the distributions around the means can be quite insightful as well. Finally, I compare heatmaps of the true community, the observed community, and the estimated community (observed with false negative probabilities).
